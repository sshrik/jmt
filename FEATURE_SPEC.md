# 📋 JMT MVP 기능 정의서

> **JMT (주식/암호화폐 전략 플랫폼) MVP 버전**  
> 버전 관리 기반 투자 전략 백테스트 및 수익률 비교 플랫폼

---

## 🎯 MVP 범위 정의

### 핵심 기능

- ✅ 프로젝트 버전별 저장 및 관리
- ✅ 시기별 수익률 추적 및 시각화
- ✅ 버전별/프로젝트별 수익률 비교
- ✅ 기본 백테스트 로직 (조건부 매매/매도/대기)
- ✅ 투자금 관리 (분할 투자, 부분 매도, 추가 투자금)

### 기술 스택

- **Frontend**: Vite + React + TypeScript
- **Styling**: Module SCSS + Mantine UI Library
- **Charts**: @mantine/charts (Recharts 기반)
- **Icons**: @tabler/icons-react (Mantine 권장)
- **Data**: Local Storage + Mock API
- **State**: React Context 또는 Zustand

---

## 📄 페이지별 상세 기능 정의

### 1️⃣ 프로젝트 목록 페이지 (`/`)

#### 📍 페이지 목적

사용자의 모든 투자 전략 프로젝트를 한눈에 보고 관리할 수 있는 대시보드

#### 🔧 주요 기능

- **프로젝트 카드 목록 표시**
  - 프로젝트명, 설명, 마지막 수정일
  - 총 버전 수, 최신 버전 수익률
  - 프로젝트별 요약 차트 (미니 차트)
- **프로젝트 관리**

  - 새 프로젝트 생성 버튼
  - 프로젝트 삭제 기능
  - 프로젝트명 수정 (인라인 편집)

- **필터링 및 정렬**
  - 수익률 순 정렬
  - 수정일 순 정렬
  - 프로젝트명 검색

#### 👤 사용자 스토리

```
AS A 투자자
I WANT TO 내가 만든 모든 투자 전략을 한 화면에서 보고 싶다
SO THAT 각 전략의 성과를 빠르게 비교하고 관리할 수 있다

GIVEN 프로젝트 목록 페이지에 접속했을 때
WHEN 프로젝트들이 수익률과 함께 표시되면
THEN 어떤 전략이 가장 효과적인지 즉시 판단할 수 있다
```

#### 🎨 UI 컴포넌트

- `ProjectCard`: 개별 프로젝트 카드
- `ProjectList`: 프로젝트 목록 컨테이너
- `CreateProjectButton`: 새 프로젝트 생성 버튼
- `SearchAndFilter`: 검색 및 필터 컴포넌트

---

### 2️⃣ 프로젝트 상세 페이지 (`/projects/:id`)

#### 📍 페이지 목적

선택한 프로젝트의 모든 버전을 보고, 버전별 성과를 비교할 수 있는 상세 대시보드

#### 🔧 주요 기능

- **프로젝트 정보 표시**

  - 프로젝트명, 설명, 생성일
  - 총 버전 수, 총 백테스트 실행 횟수

- **버전 관리**

  - 버전 목록 (최신순)
  - 각 버전별 수익률, 생성일, 메모
  - 버전 복제 기능
  - 버전 삭제 기능

- **성과 비교 차트**

  - 버전별 누적 수익률 라인 차트
  - 시기별 수익률 변화 그래프
  - 주요 지표 비교 테이블 (총 수익률, 최대 낙폭, 거래 횟수)

- **백테스트 실행**
  - 선택한 버전에 대한 백테스트 재실행
  - 다른 데이터셋으로 백테스트 실행

#### 👤 사용자 스토리

```
AS A 투자자
I WANT TO 하나의 전략에 대한 여러 버전을 비교하고 싶다
SO THAT 어떤 수정이 성과 개선에 도움이 되었는지 알 수 있다

GIVEN 프로젝트 상세 페이지에서
WHEN 여러 버전의 수익률 차트를 볼 때
THEN 전략 개선 과정을 시각적으로 추적할 수 있다
```

#### 🎨 UI 컴포넌트

- `ProjectHeader`: 프로젝트 기본 정보
- `VersionList`: 버전 목록 및 관리
- `PerformanceChart`: 성과 비교 차트
- `BacktestRunner`: 백테스트 실행 패널

---

### 3️⃣ 전략 편집 페이지 (`/projects/:id/versions/:versionId/edit`)

#### 📍 페이지 목적

시각적 블록 기반으로 투자 전략을 설계하고 편집할 수 있는 에디터

#### 🔧 주요 기능

- **전략 정보 관리**

  - 버전명, 설명 입력
  - 버전 메모 (변경사항 기록)

- **블록 기반 전략 설계**

  - **조건 블록**: 가격 조건, 기술적 지표 조건
  - **액션 블록**: 매수, 매도, 대기
  - **설정 블록**: 투자 비율, 매도 비율 설정
  - **연결선**: 블록 간 로직 흐름 정의

- **투자 설정**

  - 초기 투자금 설정
  - 매수 시 투자 비율 (현재 현금의 X%)
  - 매도 시 매도 비율 (보유 주식의 X%)
  - 추가 투자금 유치 조건

- **전략 검증**
  - 블록 연결 유효성 검사
  - 무한 루프 방지
  - 투자 비율 합계 검증

#### 👤 사용자 스토리

```
AS A 투자자
I WANT TO 복잡한 코딩 없이 투자 전략을 시각적으로 만들고 싶다
SO THAT 직관적으로 전략을 설계하고 수정할 수 있다

GIVEN 전략 편집 페이지에서
WHEN 블록을 드래그하여 연결할 때
THEN 전략의 로직이 시각적으로 명확하게 표현된다
```

#### 🎨 UI 컴포넌트

- `StrategyCanvas`: 블록 편집 캔버스
- `BlockPalette`: 사용 가능한 블록 목록
- `PropertyPanel`: 선택된 블록의 속성 편집
- `ValidationPanel`: 전략 검증 결과

---

### 4️⃣ 백테스트 결과 페이지 (`/projects/:id/versions/:versionId/results`)

#### 📍 페이지 목적

특정 버전의 백테스트 실행 결과를 상세히 분석할 수 있는 대시보드

#### 🔧 주요 기능

- **수익률 시각화**

  - 시기별 포트폴리오 가치 변화 차트
  - 누적 수익률 그래프
  - 벤치마크 대비 성과 비교

- **거래 내역**

  - 모든 매수/매도 거래 목록
  - 거래별 수익/손실
  - 거래 시점 차트 마킹

- **성과 지표**

  - 총 수익률, 연간 수익률
  - 최대 낙폭 (Maximum Drawdown)
  - 샤프 비율 (추후 구현)
  - 총 거래 횟수, 승률

- **포트폴리오 분석**
  - 현금 vs 주식 비율 변화
  - 보유 기간 분석
  - 월별/분기별 성과 분석

#### 👤 사용자 스토리

```
AS A 투자자
I WANT TO 내 전략이 과거 데이터에서 어떻게 수행되었는지 상세히 알고 싶다
SO THAT 실제 투자 전에 전략의 유효성을 검증할 수 있다

GIVEN 백테스트 결과 페이지에서
WHEN 상세한 차트와 지표를 볼 때
THEN 전략의 강점과 약점을 정확히 파악할 수 있다
```

#### 🎨 UI 컴포넌트

- `PerformanceOverview`: 주요 지표 요약
- `PortfolioChart`: 포트폴리오 가치 변화 차트
- `TradeList`: 거래 내역 테이블
- `MetricsPanel`: 상세 성과 지표

---

## 🔄 백테스트 로직 정의

### 기본 투자 규칙

1. **초기 설정**

   - 시작 현금: 사용자 정의 (기본 1,000,000원)
   - 주식 보유량: 0주
   - 수수료: 거래금액의 0.015% (편도)

2. **매수 로직**

   - 조건 충족 시 현재 현금의 지정 비율로 매수
   - 가용 현금 < 매수 금액인 경우 전액 매수
   - 매수 후 현금 및 주식 수량 업데이트

3. **매도 로직**

   - 조건 충족 시 보유 주식의 지정 비율로 매도
   - 보유 주식 < 매도 수량인 경우 전량 매도
   - 매도 후 현금 및 주식 수량 업데이트

4. **대기 로직**
   - 매수/매도 조건 미충족 시 현상 유지
   - 포트폴리오 가치 = 현금 + (주식 수량 × 현재가)

### 지원 블록 타입 (MVP)

- **조건 블록**: 가격 > X원, 가격 < X원, 가격 상승률 > X%
- **액션 블록**: 매수 (X% 비율), 매도 (X% 비율), 대기
- **설정 블록**: 초기 자금, 추가 투자금

---

## 📊 데이터 구조

### Project 데이터 모델

```typescript
interface Project {
  id: string;
  name: string;
  description: string;
  createdAt: Date;
  updatedAt: Date;
  versions: Version[];
}

interface Version {
  id: string;
  projectId: string;
  name: string;
  description: string;
  createdAt: Date;
  strategy: StrategyBlock[];
  backtestResults?: BacktestResult;
}

interface BacktestResult {
  totalReturn: number;
  maxDrawdown: number;
  tradeCount: number;
  transactions: Transaction[];
  portfolioHistory: PortfolioSnapshot[];
}
```

---

## 🎯 구현 우선순위

### Phase 1: 기본 구조 (1-2주)

- [ ] 프로젝트 설정 (Vite + React + TypeScript)
- [ ] Mantine UI + SCSS 모듈 설정
- [ ] 라우팅 설정 (React Router)
- [ ] Mantine 기반 기본 레이아웃 컴포넌트
- [ ] Mock 데이터 및 Local Storage 구조

### Phase 2: 핵심 페이지 (2-3주)

- [ ] 프로젝트 목록 페이지
- [ ] 프로젝트 상세 페이지
- [ ] 버전 관리 기능
- [ ] 기본 차트 컴포넌트

### Phase 3: 전략 에디터 (3-4주)

- [ ] 블록 기반 에디터 (React Flow 대신 간단한 UI)
- [ ] 기본 블록 타입 구현
- [ ] 전략 검증 로직

### Phase 4: 백테스트 엔진 (2-3주)

- [ ] 백테스트 로직 구현
- [ ] 결과 시각화
- [ ] 성과 지표 계산

---

## 🚀 다음 단계

1. **기술 스택 확정 및 프로젝트 초기화**
2. **Mock 데이터 구조 설계**
3. **기본 라우팅 및 레이아웃 구현**
4. **프로젝트 목록 페이지부터 순차 개발**

---

_이 문서는 개발 진행에 따라 지속적으로 업데이트됩니다._
